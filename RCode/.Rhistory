dd<-d %>% mutate(lhv=lhv*-1,lep=lep*-1)
head(dd)
dd<-dd %>%
select(rhv:lea) %>%
gather('Coef','b',1:12)
g<-ggplot(subset(dd,Coef %in% c('lhv','rhv')),aes(b,fill=Coef))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vlin(x=0)
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
is.na(5)
is.nan(Na)
is.nan(NA)
is.na(NA)
head(d)
x<-d %>% select(rhv:lea) %>% mutate_each(funs(*-1))
x<-d %>% select(rhv:lea) %>% mutate_each(*-1)
x<-d %>% select(rhv:lea) %>% mutate_each(funs(is.na))
x<-d %>% select(rhv:lea) %>% mutate_each(funs(~is.na))
x<-d %>% select(rhv:lea) %>% mutate_each(funs(!is.na))
x<-d %>% select(rhv:lea) %>% mutate_each(funs(not(is.na))
)
head(x)
?mutate_each
x<-d %>% select(rhv:lea) %>% mutate_each(funs(xx= !is.na))
x<-d %>% select(rhv:lea) %>% mutate_each(funs(xx= !is.na(.))
)
head(x)
x<-d %>% select(rhv:lea) %>% mutate_each(funs(!is.na(.)))
head(x)
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12)
#s$c<-s$c %>%
#  as.character() %>%
#  substr(.,start=1,stop=3) %>% #just take the first three letters
#  as.factor(.) %>%
#  reorder(desc(s$n)) #order by count
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12) %>%
reorder(desc(s$n))
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12) %>%
reorder(desc(.$n))
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
head(s)
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12)
head(s)
class(s$c)
reorder(c,n)
reorder(c,c$n)
reorder(s,s$n)
reorder(s$c,s$n)
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12) %>%
reorder(desc(.$n))
head(s)
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12)
reorder(s,s$n)
reorder(dec(s$n))
reorder(dec(s$n),data=s)
reorder(dec(n),data=s)
?reorder
reorder(s,n)
head(s)
reorder(s,c,n)
reorder(s,n,c)
reorder(s,s$n,s$c)
reorder(s,s$c,s$n)
reorder(s$c,s$n)
s$c<-reorder(s$c,desc(s$n))
head(s)
s
s$n<-reorder(s$n,desc(s$n))
s
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12)
mutate_each(s,funs(reorder),s$n)
mutate_each(s,funs(reorder),n)
mutate_each(s,funs(reorder))
mutate_each(s,funs(reorder(.,n)))
mutate_each(s,funs(reorder(.,s$n)))
s
order(s,n)
order(s,s$n)
arrange(s,n)
arrange(s,desc(n))
s<-arrange(s,desc(n))
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
s$c<-reorder(s$c,desc(s$n))
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12) %>%
mutate(c=reorder(desc(n)))
mutate(s,c=reorder(x))
mutate(s,c=reorder(n))
mutate(s,cc=n*2)
mutate(s,c=reorder(c,desc(n)))
s<-d %>%
select(rhv:lea) %>%
mutate_each(funs(!is.na(.))) %>%
summarise_each(funs(sum)) %>%
gather('c','n',1:12) %>%
mutate(c=reorder(c,desc(n)))
s
p<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))
p+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')
dd<-d %>%
mutate(lhv=lhv*-1,lep=lep*-1) %>%
select(rhv:lea) %>%
gather('Coef','b',1:12)
g<-ggplot(subset(dd,Coef %in% c('lhv','rhv')),aes(b,fill=Coef))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
s$n['rhv']
s
g<-ggplot(dd,aes(b,fill=Coef))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
dd<-d %>%
mutate(lhv=lhv*-1,lep=lep*-1,lhp=lhp*-1) %>%
select(rhv:lea) %>%
gather('Coef','b',1:12)
g<-ggplot(subset(dd,Coef %in% c('lhv','rhv','lhp','rhp','lep','rep')),aes(b,fill=Coef))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
dd<-d %>%
mutate(lhv=lhv*-1,lep=lep*-1,lhp=lhp*-1) %>%
select(rhv:lea) %>%
gather('Coef','b',1:12)
g<-ggplot(subset(dd,Coef %in% c('lhv','rhv','lhp','rhp','lep','rep')),aes(b,fill=count))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
dd<-d %>%
mutate(lhv=lhv*-1,lep=lep*-1,lhp=lhp*-1) %>%
select(rhv:lea) %>%
gather('Coef','b',1:12)
g<-ggplot(subset(dd,Coef %in% c('lhv','rhv','lhp','rhp','lep','rep')),aes(b,fill=Coef))
g+geom_histogram(alpha=1)+facet_grid(Coef~.)+geom_vline(x=0)
g
g+geom(histogram)
g+geom_histogram()
g+geom_density(alpha=0.5)
install.packages(plot.ly)
install.packages(devtools)
install.packages("devtools")
install.packages("plotly")
staticBestFitLR <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
View(staticBestFitLR)
s
t
View(staticBestFitLR)
t<-StaticBestFitLR %>%
gather('coef','b',rep:lhp)
library(dplyr)
library(tidyr)
t<-StaticBestFitLR %>%
gather('coef','b',rep:lhp)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp)
View(t)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(coef)
View(t)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(coef) %>%
summarise_each(mcoef=coef[coef==max(b)])
summarise(mcoef=coef[coef==max(b)])
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(coef) %>%
summarise_each(mcoef=funs(coef[coef==max(b)])
)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(coef) %>%
summarise(mm=max(b))
View(t)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(Neuron) %>%
summarise(mm=max(b))
View(t)
t<-staticBestFitLR %>%
gather('coef','b',rep:lhp) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
View(t)
library(ggplot2)
qplot(t,mm)
qplot(data=t,mm)
qplot(data=t,cc)
t
t$cc[t$cc==rep]='Eye.Position.Rightward'
class(t$cc)
?rename
t<-staticBestFitLR %>%
rename(rep=Rightward.Eye.Position,lep=Leftward.Eye.Position,rhp=Rightward.Head.Position)
gather('coef','b',4:7) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
t<-staticBestFitLR %>%
rename(rep=Rightward.Eye.Position,lep=Leftward.Eye.Position,rhp=Rightward.Head.Position)
gather('coef','b',Rightward.Eye.Position:lhp) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
t<-staticBestFitLR %>%
rename(rep=RightwardEyePosition,lep=LeftwardEyePosition,rhp=RightwardHeadPosition)
gather('coef','b',Rightward.Eye.Position:lhp) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
t<-staticBestFitLR %>%
rename(rep=RightwardEyePosition,lep=LeftwardEyePosition,rhp=RightwardHeadPosition)
t<-staticBestFitLR %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp)
gather('coef','b',Rightward.Eye.Position:lhp) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
t<-staticBestFitLR %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp)
gather('coef','b',4:7) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
t<-staticBestFitLR %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:7) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
qplot(data=t,cc)
t<-staticBestFitLR %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:7) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
n<-t %>%
group_by(cc) %>%
summarize(n())
reorder(t$cc,n)
n
n<-t %>%
group_by(cc) %>%
summarize(n=n())
n
reorder(t$cc,n$n)
t$cc
t<-staticBestFitLR %>%
select(c('rep','lep','rhp')) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
n<-t %>%
group_by(cc) %>%
summarize(n=n())
t<-staticBestFitLR %>%
select(4:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
n<-t %>%
group_by(cc) %>%
summarize(n=n())
t<-staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])
n<-t %>%
group_by(cc) %>%
summarize(n=n())
reorder(t$cc,n$n)
d<-read.csv('peakregressions.csv')
head(d)
d[1,2]
d<-d[,2:end]
d<-d[,2:]
d<-d[,2:13]
head(d)
d<-d[,1:11]
head(d)
sum(d$r.r<0.001)
sum(d$p.r<0.001)
sum(d$p.l<0.001)
sum(d$p.l<0.001&d$p.r<0.001)
qplot(d$slope.r)
qplot(d$slope.r,color=d$p.r)
qplot(d$slope.r,color=d$r.r)
qplot(d$slope.r)+geom_histogram(color=r$r.r)
qplot(d$slope.r)+geom_histogram(color=d$r.r)
qplot(d.slope.r,d.slope.l)
qplot(d$slope.r,d$slope.l)
qplot(d$slope.r,d$slope.l,color=1/d$p.r)
qplot(d$slope.r,d$slope.l,color=d$p.r)
qplot(d$slope.r,d$slope.l,size=d$p.r)
qplot(d$slope.r,d$slope.l,size=(1-d$p.r))
qplot(d$slope.r,d$slope.l,size=1-d$p.r)
qplot(data=subset(d,p.r<0.001),slope.r)
qplot(data=subset(d,p.r<0.001),slope.r,binwidth=0.1)
qplot(data=subset(d,p.r<0.001),slope.r,binwidth=0.2)
qplot(data=subset(d,p.r<0.001),slope.r,binwidth=0.1)
qplot(data=subset(d,p.l<0.001),slope.l,binwidth=0.1)
dd<-subset(d,p.l<0.001)
meandd(dd$p.l)
mean(dd$p.l)
mean(dd$slope.l)
dd<-subset(d,p.l<0.001 & slope.l<0)
mean(dd$slope.l)
qplot(data=dd,slope.l)
qplot(data=dd,slope.l,binwidth=0.1)
qplot(data=dd,slope.l,binwidth=0.05)
dd.r<-subset(d,p.r<0.001 % sploe.r>0)
dd.r<-subset(d,p.r<0.001 & sploe.r>0)
dd.r<-subset(d,p.r<0.001 & slope.r>0)
qplot(data=dd.r,slope.l,binwidth=0.05)
qplot(data=dd.r,slope.r,binwidth=0.05)
head(d)
tall<-d %>%
gather('dir','n',c(2,7))
head(tall)
tall<-d %>%
gather('dir','n',c(2,7)) %>%
gather('dir','slope',c('slope.r','slope.l'))
tall<-d %>%
gather('dir','n',c(2,7)) %>%
gather('dir','slope',c(2,5))
head(tall)
tall<-d %>%
gather('dir','n',c(2,7)) %>%
gather('dir','slope',c(2,6)) %>%
gather('dir','int',c(2,5)) %>%
gather('dir','r',c(2,4)) %>%
gather('dir','p',c(2,3))
head(tall)
head(tall,10)
tall
head(tall)
tall$dir[tall$dir=='n.r']='R'
tall$dir[as.char(tall$dir=='n.r')]='R'
tall$dir[as.character(tall$dir=='n.r')]='R'
tall<-d %>%
gather('dir.n','n',c(2,7)) %>%
gather('dir.s','slope',c(2,6)) %>%
gather('dir.i','int',c(2,5)) %>%
gather('dir.r','r',c(2,4)) %>%
gather('dir.p','p',c(2,3))
head(tall)
tall<-d %>%
gather('dir.n','n',c(2,7)) %>%
gather('dir.s','slope',c(2,6)) %>%
gather('dir.i','int',c(2,5)) %>%
gather('dir.r','r',c(2,4)) %>%
gather('dir.p','p',c(2,3)) %>%
select(c(1,2,3,5,7,9,11))
head(tall)
tall$dir.n<-as.character(tall$dir.n)
tall$dir.n[tall$dir.n=='n.r']='R'
tall$dir.n[tall$dir.n=='n.l']='L'
head(tall)
rename(tall,dir=dir.n)
head(tall)
tall<-d %>%
gather('dir.n','n',c(2,7)) %>%
gather('dir.s','slope',c(2,6)) %>%
gather('dir.i','int',c(2,5)) %>%
gather('dir.r','r',c(2,4)) %>%
gather('dir.p','p',c(2,3)) %>%
select(c(1,2,3,5,7,9,11))
tall$dir.n<-as.character(tall$dir.n)
tall$dir.n[tall$dir.n=='n.r']='R'
tall$dir.n[tall$dir.n=='n.l']='L'
tall$dir.n<-as.factor(tall$dir.n)
tall<-rename(tall,dir=dir.n)
head(tal)
head(tall)
qplot(slope)
qplot(slope,data=tall)
qplot(slope,data=tall,facets=.~dir)
qplot(slope,data=tall,facets=dir~.)
View(d)
tall<-d%>%
rename(R=dir.r,L=dir.l)
head(d)
tall<-d%>%
rename(R=slope.r,L=slope.l)
head(tall)
tall<-d%>%
rename(R=slope.r,L=slope.l) %>%
gather('dir','slope',c(2,7))
tall<-d%>%
gather(key,value,-Neuron)
head(tall)
?extract
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'\.[lr]')
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'(\.[lr])')
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'(\\.[lr])')
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'(.\\.[lr])')
tall<-d%>%
gather(key,value,-Neuron)
head(tall)
regexec('.\\.r','slope.r')
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'(.)\\.)')
head(tall)
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('n','slope','intercept','r','p'),'(.\\.).')
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('value','dir'),'(.)\\.(.)')
head(tall)
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('param','dir'),'(.)\\.(.)')
head(tall)
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('param','dir'),'(.)\\.(.)') %>%
spread(param,value)
head(tall)
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('param','dir'),'(^.)\\.(.)') %>%
spread(param,value)
tall<-d%>%
gather(key,value,-Neuron) %>%
extract(key,c('param','dir'),'([a-z]*)\\.(.)') %>%
spread(param,value)
head(tall)
qplot(slope,data=tall,facets=dir~.)
qplot(slope,data=tall,facets=dir~.)+geom_vline(x=0)
qplot(slope,data=tall,color=dir)+geom_vline(x=0)
qplot(slope,data=tall,color=dir,geom='density')+geom_vline(x=0)
qplot(slope,data=tall,color=dir,geom='density',alpha=0.5)+geom_vline(x=0)
qplot(slope,data=tall,color=dir,geom='density',alpha=0.5)+geom_vline(x=0)+geom_density
qplot(slope,data=tall,color=dir,geom='density',alpha=0.5)+geom_vline(x=0)+geom_density()
g
g<-ggplot(data=tall,aes(slope))
g+geom_density()
g+geom_density(color='dir')
g<-ggplot(data=tall,aes(slope,color=density))
g+geom_density(alpha=0.5)
g<-ggplot(data=tall,aes(slope)color=density)
g<-ggplot(data=tall,aes(slope),color=density)
g+geom_density(alpha=0.5)
g<-ggplot(data=tall,aes(slope),color=dir)
g+geom_density(alpha=0.5)
qplot(slope,data=tall,fill=dir,geom='density',alpha=0.5)+geom_vline(x=0)
qplot(slope,data=tall,fill=dir,geom='density')+geom_vline(x=0)
qplot(slope,data=tall,fill=dir,geom='density',alpha=0.2)+geom_vline(x=0)
qplot(slope,data=tall,fill=dir,geom='density',alpha=0.1)+geom_vline(x=0)
qplot(slope,data=tall,fill=dir,geom='density')+geom_vline(x=0)
g+geom_density(alpha=0.5)
g<-ggplot(data=tall,aes(slope),fill=dir)
g+geom_density(alpha=0.5)
g+geom_histogram(alpha=0.5)
g<-ggplot(data=tall,aes(slope,fill=dir))
g+geom_histogram(alpha=0.5)
g+geom_density(alpha=0.5)
g+geom_histogram(alpha=0.5)
g+geom_density(alpha=0.5)
g+geom_histogram(alpha=0.5)
g<-ggplot(data=tall,aes(slope,color=dir))
g+geom_histogram(alpha=0.5)
g<-ggplot(data=tall,aes(slope,fill=dir))
g+geom_histogram(alpha=1)
g+geom_bar(alpha=1)
g+geom_density(alpha=0.5)
g+geom_density(alpha=0.2)
g+geom_density(alpha=0.7)
g+geom_density(alpha=0.7)+geom_vline(x=0)
g+geom_density(alpha=0.7)+geom_vline(x=0,width=2)
g+geom_density(alpha=0.7)+geom_vline(x=0)
