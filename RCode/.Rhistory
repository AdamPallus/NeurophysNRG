tall<-g %>% gather(key,value,rhv:rhp)
n<-tall %>%
group_by(key) %>%
summarise(Count=(sum(!is.na(.$values))))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
tall$key<-factor(tall$key,levels=c('rhv','lhv','rep','lep','rhp','rha','lha'))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
g<-subset(gs,rsquared>0) #gs loaded
tall<-g %>% gather(key,value,c('rhv','lhv','rep','lep','rhp','rha'))
n<-tall %>%
group_by(key) %>%
summarise(Count=(sum(!is.na(.$values))))
tall$key<-factor(tall$key,levels=c('rhv','lhv','rep','lep','rhp','rha','lha'))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
g<-subset(gs,rsquared>0) #gs loaded
tall<-g %>% gather(key,value,c('rhv','lhv','rep','lep','rhp','rha'))
n<-tall %>%
group_by(key) %>%
summarise(Count=(sum(!is.na(.$values))))
tall$key<-factor(tall$key,levels=c('rhv','lhv','rep','lep','rhp','rha'))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
head(g)
g<-subset(gs,rsquared>0) #gs loaded
tall<-g %>% gather(key,value,c(6,7,8,9,10,12))
n<-tall %>%
group_by(key) %>%
summarise(Count=(sum(!is.na(.$values))))
tall$key<-factor(tall$key,levels=c('rhv','lhv','rep','lep','rhp','rha'))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
d$Neuron[1]
as.Date(d$Neuron[1],../%d%m%y)
as.Date(d$Neuron[1],%d%m%y)
as.Date(d$Neuron[1],SB%d%m%y)
as.Date(d$Neuron[1],%d%m%y)
as.Date(10jan12,%d%m%y)
as.Date(d$Neuron[1],'SB%d%m%y')
as.Date(d$Neuron[1],'%d%m%y')
class(d$Neuron)
n<-as.character(d$Neuron)
as.Date(n[1],'SB%d%m%y')
as.Date(n[1],'%d%m%y')
as.Date(10jan12,'%d%m%y')
as.Date('10jan12','%d%m%y')
as.Date('10/jan/12','%d/%m/%y')
as.Date(c('2007-06-22','2004-02-13'))
as.Date(c('2007-06-22','2004-02-13'),'%Y-%m-%d')
as.Date('10/jan/12','%d/%m/%y')
as.Date(n[1],'SB%d%b%y')
as.Date(n[1],'..%d%b%y')
as.Date(n[1],'%d%b%y')
as.Date(n[1],'SB%d%b%y')
n<-substr(n,start=3,stop=nchar(n))
head(n)
n<-as.Date(n,'%m%b%y')
head(n)
n<-as.Date(n,'%d%b%y')
n<-as.character(d$Neuron)
head(n)
n<-substr(n,start=3,stop=nchar(n))
nn<-as.Date(n,'%m%b%y')
head(nn)
head(n)
nn<-as.Date(n,'%d%b%y')
head(nn)
d$date<-nn
arrange(d,dec(date))
a<-arrange(d,date)
head(a)
a$Neuron
t(a$Neuron)
a$Neuron
aa<-a$Neuron
View(aa)
m<-substr(aa$Neuron,start=1,stop=2)
m<-substr(aa,start=1,stop=2)
m[1]
aa<-data.frame(aa,m)
View(aa)
m<-substr(aa$aa,start=1,stop=1)
aa$m<-m
View(aa)
View(subset(aa,m==='U'))
View(subset(aa,m=='U'))
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
library(ggplot2)
qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name="Trial\nType")
staticBestFitLR <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])-> t
library(dplyr)
staticBestFitLR <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])-> t
library(tidyr)
staticBestFitLR <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(mm=max(b),cc=coef[b==mm])-> t
head(t)
n<-t %>%
group_by(cc) %>%
summarize(n=n())
n
t
?arrange
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(Highest.Coef=max(b),Type=coef[b==mm]) %>%
arrange(desc(Highest.Coef)-> t
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(Highest.Coef=max(b),Type=coef[b==mm]) %>%
arrange(desc(Highest.Coef))-> t
staticBestFitLR %>%
select(1:6) %>%
rename(Rightward.Eye.Position=rep,Leftward.Eye.Position=lep,Rightward.Head.Position=rhp) %>%
gather('coef','b',4:6) %>%
group_by(Neuron) %>%
summarise(Highest.Coef=max(b),Type=coef[b==Highest.Coef]) %>%
arrange(desc(Highest.Coef))-> t
t
gs<-read.csv('~/MATLAB/NeurophysNRG/fitGSPlm.csv')
head(gs)
g<-subset(gs,rsquared>0)
tall<-g %>% gather(key,value,c(6,7))
qplot(key,value,data=tall,geom='boxplot',fill=gsp)
qplot(key,value,data=tall,geom='line',color=gsp)
qplot(key,value,data=tall)
qplot(key,value,data=tall,color=gsp)
g %>% gather(key,value,c(6,7)) %>% group_by(Neuron)
g %>% gather(key,value,c(6,7)) %>% group_by(Neuron)-> tall
qplot(key,value,data=tall,color=gsp)
qplot(key,value,data=tall,color=gsp,geom=line)
?diff
?subtract
?'-'
library(dplyr)
library(ggplot2)
p<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings="NaN")
qplot(head_peak,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=10)
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%
merge(p,by="Neuron")->
m
head(m)
qplot(head_peak,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm')
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
qplot(head_peak,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm')
qplot(head_peak,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)
qplot(head_peak,maxsdf*1400,data=subset(p,head_peak>0))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) -> m
head(m)
sum(m$p.right<0.001)
sum(m$p.right>0.001)
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) ->m
sum(m$p.left<0.001)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8]) ->m
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0))))$coefficients[8]) ->m
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8]) ->m
head(m)
sum(m$p.left<0.001)
sum(m$p.left<0.051)
filter(m,p.left<0.001)
filter(m,p.left<0.001,p.right<0.001)
filter(m,p.left<0.001,p.right>=0.001)
filter(m,p.left>=0.001,p.right<0.001)
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%
merge(p,by="Neuron")->
m
qplot(head_peak,maxsdf*1400,data=filter(p,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=1)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-1)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-0.5)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=4)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-0.2)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=factor(isgs),data=filter(m,head_peak>0,p.right<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-0.2)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=factor(isgs),data=filter(m,head_peak<0,p.left<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-0.2)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
filter(head_peak>0) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%
merge(p,by="Neuron")%>%
group_by(Neuron)%>%
filter(head_peak<0) %>%
do(p.left=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%
merge(p,by="Neuron")->
m
qplot(head_peak,maxsdf*1400,col=factor(isgs),data=filter(m,head_peak<0,p.left<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,vjust=-0.2)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=factor(isgs),data=filter(m,head_peak<0,p.left<0.001))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=1,vjust=-0.2)+stat_smooth(method='lm')
m<-lm(maxsdf~head_peak*factor(isgs),data=subset(p,Neuron=='SC18Oct11'))
summary(m)
p$isgs<-as.factor(p$isgs)
summary(m)$coefficients[8]
summary.aov(m)
str(summary.aov(m))
str(summary.aov(m))$'Pr(>F)'
summary.aov(m)$'Pr(>F)'
summary.aov(m)$Pr(>F)
summary.aov(m)$"Pr(>F)"
summary.aov(m)$Pr
summary.aov(m)[,5]
summary.aov(m)[,4]
summary.aov(m)
m
summary(m)
summary.aov(m)
step(m)
summary.aov(m)
summary(m)
qplot(head_peak,maxsdf,col=isgs,data=subset(p,Neuron=='SC18Oct11'))
qplot(head_peak,maxsdf,col=isgs,data=subset(p,Neuron=='SC18Oct11'))+stat_smooth(method='lm')
qplot(head_peak,maxsdf,col=isgs,data=filter(p,Neuron=='SC18Oct11',head_peak>0))+stat_smooth(method='lm')
m<-lm(maxsdf~head_peak*factor(isgs),data=filter(p,Neuron=='SC18Oct11',head_peak>0))
summary(m)
summary(m)$cofficients
summary(m)$cofficient
summary(m)$coefficients[8]
summary(m)$coefficients[11]
summary(m)$coefficients[12]
p<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings="NaN")
qplot(maxh,maxsdf*1400,data=subset(p,head_peak>0))+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(maxh,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(minh,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(minh,maxsdf*1400,data=p,col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
p$isgs<-as.factor(p$isgs)
qplot(minh,maxsdf*1400,data=p,col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8]) ->mm
head(mm)
m<-lm(maxsdf~head_peak*factor(isgs),data=filter(p,Neuron=='SC18Oct11',head_peak>0))
summary(m)
m<-lm(maxsdf~head_peak,data=filter(p,Neuron=='SC18Oct11',head_peak>0))
summary(m)
summary(m)$coefficients[8]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[11]) ->mm
head(mm)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[11],
p.right.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[12],
p.right.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[11]) ->mm
qplot(head_peak,maxsdf*1400,data=filter(mm,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak<0,p.left.int<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=pp)
qplot(head_peak,maxsdf*1400,data=pp)+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001)+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=2)
summary(pp$p.left.int)
pp$p.left.int[1]
pp$p.left.int[2]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[11],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[12],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[11]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, p.left.slope<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, Neuron=='SC23Sep11'))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, p.left.slope<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
n
nn
nn<-filter(p,Neuron='SC23Sep11')
nn<-filter(p,Neuron=='SC23Sep11')
lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0))
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))[12]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))[11]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[11]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[12]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[15]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[16]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<-20)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<-20)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<-20)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.slope<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.slope<0.001 | p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method-'lm',geom='text',parse=TRUE,hjust=0)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)
```{r peakAnalysis,fig.width=7, fig.height=33}
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=8)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=2)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=4)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
source('~/.active-rstudio-document')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_grid(isgs~Neuron)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')#+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)
help(summary.lm)
head(p)
unique(p$Neuron)
length(unique(p$Neuron))
length(unique(p[,p.right<0.001]$Neuron))
length(unique(pp[,pp$p.right<0.001]$Neuron))
head(pp)
length(unique(pp))
length(unique(pp$Neuron))
length(unique(pp[pp$p.right<0.001,]$Neuron))
length(unique(pp[pp$p.left<0.001,]$Neuron))
length(unique(pp[pp$p.left<0.001&pp$p.right<0.001,]$Neuron))
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))
library(dplyr)
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
n.total<-length(unique(pp$Neuron))
n.left<-length(unique(pp[pp$p.left<0.001,]$Neuron))
n.left.slope<-length(unique(pp[pp$p.left.slope<0.001,]$Neuron))
n.left.int<-length(unique(pp[pp$p.left.int<0.001,]$Neuron))
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))->
n.left.either
n.left.either<-length(unique((pp[pp$p.left<0.001&(p.left.slope<0.001 | p.left.int<0.001))
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)
)
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)))
p$isgs<-as.factor(p$isgs)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
pp<-merge(mm,p,by="Neuron")
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)))
n.left.either<-length(unique((pp[pp$p.left<0.001&pp$p.left.slope<0.001 | pp$p.left.int<0.001,]$Neuron)))
n.left.either
n.left.either<-length(unique((pp[pp$p.left<0.001&(pp$p.left.slope<0.001 | pp$p.left.int<0.001),]$Neuron)))
n.left.either
View(mm)
p$isgs<-as.factor(p$isgs)
levels(p$isgs)<-c('Pursuit','Gaze Shift')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
head(mm)
write.table(mm,'gspsSTATS.csv')
write.csv(mm,'gspsSTATS.csv')
class(mm)
write.csv(mm,'~/gspsSTATS.csv')
write.csv(mm)
write.table(mm,'gspsSTATS.csv',sep=',')
mmm<-data.frame(mm)
write.table(mm,'gspsSTATS.csv',sep=',')
class(mm)
head(mm)
class(mm$p.left)
mm$p.left[1]
mm$p.left[[1]]
write.table(mmm,'gspsSTATS.csv',sep=',')
mmm<-ungroup(mm)
class(mmm$p.left)
write.table(mmm,'gspsSTATS.csv',sep=',')
mmm<-unlist(mm)
class(mmm)
head(mmm)
head(mm)
mm$p.right<-unlist(mm$p.right)
class(mm$p.right)
class(mm$p.left)
mmm<-as.data.frame(lapply(mm,unlist))
head(mmm)
class(mmm$p.right)
write.table(mmm,'gspsSTATS.csv',sep=',')
?write.table
rownames(mmm)
rownames(mmm)<-NULL
head(mmm)
rownames(mmm)<-''
write.table(mmm,'gspsSTATS.csv',sep=',',row.names=FALSE)
head(staticBestFitLR)
verticalFits <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
head(verticalFits)
verticalFits <- read.csv("~/MATLAB/NeurophysNRG/Resort/regressionUDfinal.csv", na.strings="NaN")
