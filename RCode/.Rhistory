group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8]) ->mm
head(mm)
m<-lm(maxsdf~head_peak*factor(isgs),data=filter(p,Neuron=='SC18Oct11',head_peak>0))
summary(m)
m<-lm(maxsdf~head_peak,data=filter(p,Neuron=='SC18Oct11',head_peak>0))
summary(m)
summary(m)$coefficients[8]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[11]) ->mm
head(mm)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[11],
p.right.slope=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[12],
p.right.int=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[11]) ->mm
qplot(head_peak,maxsdf*1400,data=filter(mm,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak<0,p.left.int<0.001),col=isgs)+facet_wrap(~Neuron,ncol=2)+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,data=pp)
qplot(head_peak,maxsdf*1400,data=pp)+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001)+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=2)
summary(pp$p.left.int)
pp$p.left.int[1]
pp$p.left.int[2]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[12],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[11],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[12],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[11]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=2)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,p.left.int<0.001))+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001 | p.left.slope<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, p.left.slope<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, Neuron=='SC23Sep11'))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0, p.left.slope<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
n
nn
nn<-filter(p,Neuron='SC23Sep11')
nn<-filter(p,Neuron=='SC23Sep11')
lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0))
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))[12]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))[11]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[11]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[12]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[15]
summary(lm(maxsdf~head_peak*isgs,data=filter(nn,head_peak<0)))$coefficients[16]
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>0)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<0)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<0)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>0)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak<-20)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<-20)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak<-20)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->mm
pp<-merge(mm,p,by="Neuron")
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak<0,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.slope<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left.slope<0.001 | p.left.int<0.001),pleft<0.001)+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method-'lm',geom='text',parse=TRUE,hjust=0)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)
```{r peakAnalysis,fig.width=7, fig.height=33}
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=8)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=2)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=4)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
source('~/.active-rstudio-document')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_grid(isgs~Neuron)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0,size=3)
qplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')#+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)
help(summary.lm)
head(p)
unique(p$Neuron)
length(unique(p$Neuron))
length(unique(p[,p.right<0.001]$Neuron))
length(unique(pp[,pp$p.right<0.001]$Neuron))
head(pp)
length(unique(pp))
length(unique(pp$Neuron))
length(unique(pp[pp$p.right<0.001,]$Neuron))
length(unique(pp[pp$p.left<0.001,]$Neuron))
length(unique(pp[pp$p.left<0.001&pp$p.right<0.001,]$Neuron))
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))
library(dplyr)
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
n.total<-length(unique(pp$Neuron))
n.left<-length(unique(pp[pp$p.left<0.001,]$Neuron))
n.left.slope<-length(unique(pp[pp$p.left.slope<0.001,]$Neuron))
n.left.int<-length(unique(pp[pp$p.left.int<0.001,]$Neuron))
pp %>% filter(pp,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001) %>%
summarize(n.left.either=length(unique(Neuron)))->
n.left.either
n.left.either<-length(unique((pp[pp$p.left<0.001&(p.left.slope<0.001 | p.left.int<0.001))
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)
)
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)))
p$isgs<-as.factor(p$isgs)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
pp<-merge(mm,p,by="Neuron")
n.left.either<-length(unique((pp[pp$p.left<0.001&p.left.slope<0.001 | p.left.int<0.001,]$Neuron)))
n.left.either<-length(unique((pp[pp$p.left<0.001&pp$p.left.slope<0.001 | pp$p.left.int<0.001,]$Neuron)))
n.left.either
n.left.either<-length(unique((pp[pp$p.left<0.001&(pp$p.left.slope<0.001 | pp$p.left.int<0.001),]$Neuron)))
n.left.either
View(mm)
p$isgs<-as.factor(p$isgs)
levels(p$isgs)<-c('Pursuit','Gaze Shift')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
p.left.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],
p.left.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],
p.right.slope=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],
p.right.int=
summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->
mm
head(mm)
write.table(mm,'gspsSTATS.csv')
write.csv(mm,'gspsSTATS.csv')
class(mm)
write.csv(mm,'~/gspsSTATS.csv')
write.csv(mm)
write.table(mm,'gspsSTATS.csv',sep=',')
mmm<-data.frame(mm)
write.table(mm,'gspsSTATS.csv',sep=',')
class(mm)
head(mm)
class(mm$p.left)
mm$p.left[1]
mm$p.left[[1]]
write.table(mmm,'gspsSTATS.csv',sep=',')
mmm<-ungroup(mm)
class(mmm$p.left)
write.table(mmm,'gspsSTATS.csv',sep=',')
mmm<-unlist(mm)
class(mmm)
head(mmm)
head(mm)
mm$p.right<-unlist(mm$p.right)
class(mm$p.right)
class(mm$p.left)
mmm<-as.data.frame(lapply(mm,unlist))
head(mmm)
class(mmm$p.right)
write.table(mmm,'gspsSTATS.csv',sep=',')
?write.table
rownames(mmm)
rownames(mmm)<-NULL
head(mmm)
rownames(mmm)<-''
write.table(mmm,'gspsSTATS.csv',sep=',',row.names=FALSE)
head(staticBestFitLR)
verticalFits <- read.csv("~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv", na.strings="NaN")
head(verticalFits)
verticalFits <- read.csv("~/MATLAB/NeurophysNRG/Resort/regressionUDfinal.csv", na.strings="NaN")
library(ggplot2)
head(p)
levels(p$Neuron)
neurons<-levels(p$Neuron)
n.neurons<-length(neurons)
n.neurons
n.neurons/4
floor(n.neurons/4)
pppp<-subset(p,Neuron %in% neurons(1:10))
pppp<-subset(p,Neuron %in% neurons[1:10]
)
qplot(head_peak,maxsdf*1400,data=pppp)
qplot(head_peak,maxsdf*1400,data=pppp)+facet_wrap(~Neuron,ncol=3)
51/9
51/12
9*4+6
9*5+6
staticBestFitLR
head(p)
head(z)
z<-subset(p,Neuron=='SD04Jan12')
lm(maxsdf ~ head_peak,data=z)
m<-summary(lm(maxsdf ~ head_peak,data=z))
m
m$coefficients[8]
m$coefficients[2]
m$rsquared
m$coefficients[9]
str(m)
m$r.squared
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared)->
mm
pp<-merge(mm,p,by="Neuron")
library(dplyr)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared)->
mm
pp<-merge(mm,p,by="Neuron")
?filter
head(mm)
m
m$coefficients[2]
m$coefficients[1]
class(m)
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared,
int.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[1],
int.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[1],)->
mm
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared,
int.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[1],
int.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[1])->
mm
head(mm)
arrange(mm,desc(max(r.right,r.left)))
mm$max.r=max(r.left,r.right)
mm$max.r=max(mm$r.left,mm$r.right)
?do
coef(m)
m<-lm(maxsdf ~ head_peak,data=z)
coef(m)
as.data.frame(coef(summary(m)))
mm<-arrange(mm,desc(max.r))
head(mm)
mm$max.r=max(mm$r.left,mm$r.right)
mm<-mutate(mm,max.r=max(r.left,r.right))
head(mm)
mm<-arrange(mm,desc(max.r))
kable(mm)
kable(t)
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(mm,desc(max.r)) ->
t
p<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings="NaN")
p$isgs<-as.factor(p$isgs)
levels(p$isgs)<-c('Pursuit','Gaze Shift')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared,
int.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[1],
int.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[1])->
mm
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(mm,desc(max.r)) ->
t
kable(t)
library(kable)
library(knitr)
kable(t)
head(t)
kable(as.data.table(t))
kable(as.data.frame(t))
kable(t,digits=2)
head(t)
kable([1:2,],t,digits=2)
kable(t[1:2,],t,digits=2)
t[1:2,]
t[,1:2]
kable(t[,1:2])
kable(ungroup(t))
kable(unclass(t))
class(t)
as.data.table(t)
as.data.frame(t)
t<-as.data.frame(t)
head(t)
t$Neuron[1]
class(t)
class(t$int.left)
sapply(t,unclass)
t<-sapply(t,unclass)
kable(t)
t
head(t)
t[1,1]
class(t$int.right)
kable(t)
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(mm,desc(max.r)) ->
t
head(t)
head(as.data.frame(t))
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(mm,desc(max.r)) %>%
as.data.frame(.)->
t
kable(t)
colnames(t)
colnames(t[,2:3])
kable(t[,2:3])
t[,2:3]
mm
mm$Neuron
kable(mm)
mm
size(mm$p.right)
length(mm$p.right)
length(mm$slope.left)
length(mm$int.right)
length(mm$r.right)
kable(p)
head(p)
class(p)
class(mm)
install.packages(c("colorspace", "formatR", "ggplot2", "highr", "jsonlite", "KernSmooth", "manipulate", "mime", "R.methodsS3", "R.oo", "R.utils", "Rcpp"))
install.packages(c("boot", "class", "cluster", "codetools", "foreign", "KernSmooth", "lattice", "MASS", "Matrix", "mgcv", "nlme", "nnet", "rpart", "spatial", "survival"), lib="C:/Program Files/R/R-3.1.2/library")
install.packages(c("colorspace", "formatR", "ggplot2", "highr",
install.packages(c("colorspace", "formatR", "ggplot2", "highr", "jsonlite", "KernSmooth", "manipulate", "mime", "R.methodsS3", "R.oo", "R.utils", "Rcpp"))
install.packages(c("boot", "class", "cluster", "codetools", "foreign", "KernSmooth", "lattice", "MASS", "Matrix", "mgcv", "nlme", "nnet", "rpart", "spatial", "survival"), lib="C:/Program Files/R/R-3.1.2/library")
install.packages(c("colorspace", "formatR", "ggplot2", "highr",
install.packages('ggplot2')
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
?pander
??pander
head(t)
head(mm)
filename<-"~/MATLAB/NeurophysNRG/bestFitLRResort.csv"
d <- read.csv(filename, na.strings="NaN")
r<-read.csv('~/MATLAB/NeurophysNRG/RCode/peakregressions.csv')
gs<-read.csv('~/MATLAB/NeurophysNRG/fitGSPlm.csv')
r<-r[,2:12]
p<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings="NaN")
source('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R') #function to add formula to regression
p$isgs<-as.factor(p$isgs)
levels(p$isgs)<-c('Pursuit','Gaze Shift')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared,
int.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[1],
int.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[1])->
mm
pp<-merge(mm,p,by="Neuron")
n.total<-length(unique(pp$Neuron))
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(xtable)
p$isgs<-as.factor(p$isgs)
levels(p$isgs)<-c('Pursuit','Gaze Shift')
p %>%
group_by(Neuron) %>%
do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],
p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],
slope.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[2],
slope.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[2],
r.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$r.squared,
r.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$r.squared,
int.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[1],
int.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[1])->
mm
pp<-merge(mm,p,by="Neuron")
n.total<-length(unique(pp$Neuron))
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(mm,desc(max.r)) %>%
as.data.frame(.)->
t
head(t)
kable(t)
kable(t[,2:3])
t[,2:3]
t
mm
kable(mm)
kable(mm[,2:3])
format(mm)
kable(format(mm))
help format
?format
length(t)
length(mm)
mm
length(t$Neuron)
length(mm$Neuron)
mm<-mutate(mm,max.r=max(r.left,r.right))
length(mm$Neuron)
head(mm)
head(format(mm))
mmm<-format(mm)
class(mmm$int.left)
mmm<-as.data.frame(mmm)
class(mmm$int.left)
mm %>%
mutate(max.r=max(r.left,r.right)) %>%
arrange(desc(max.r))->
t
head(t)
kable(head(t))
