{
    "contents" : "#fn<-\"~/MATLAB/NeurophysNRG/Resort/SC07Oct11Test.csv\"\nfn<-\"~/MATLAB/NeurophysNRG/Resort/SC15Sep11test.csv\"\ndd<-read.csv(fn,na.strings=\"NaN\")\n\no<-dd %>%\n  group_by(trial)%>%\n  summarize(hmax=max(max(rhv),abs(min(lhv))),fmax=max(fr),fmean=mean(fr))\n\nstaticBestFitLR <- read.csv(\"~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv\", na.strings=\"NaN\")\n\nstaticBestFitLR %>%\n  select(1:6) %>%\n  rename(Rightward.Eye=rep,Leftward.Eye=lep,Rightward.Head=rhp) %>%\n  gather('coef','b',4:6) %>%\n  group_by(Neuron) %>%\n  summarise(Highest.Coef=max(b),Position.Type=coef[b==Highest.Coef]) %>%\n  arrange(desc(Highest.Coef))-> t\n\nn<-t %>%\n  group_by(cc) %>%\n  summarize(n=n())\n\n\ntall<-d %>%\n  gather('dir.n','n',c(2,7)) %>%\n  gather('dir.s','slope',c(2,6)) %>%\n  gather('dir.i','int',c(2,5)) %>%\n  gather('dir.r','r',c(2,4)) %>%\n  gather('dir.p','p',c(2,3)) %>%\n  select(c(1,2,3,5,7,9,11))\n\ntall$dir.n<-as.character(tall$dir.n)\ntall$dir.n[tall$dir.n=='n.r']='R'\ntall$dir.n[tall$dir.n=='n.l']='L'\ntall$dir.n<-as.factor(tall$dir.n)\ntall<-rename(tall,dir=dir.n)\n\ntall<-d%>%\n  gather(key,value,-Neuron) %>%\n  extract(key,c('param','dir'),'([a-z]*)\\\\.(.)') %>%\n  spread(param,value)\n\n#peak peak analysis\nlibrary(dplyr)\nlibrary(ggplot2)\np<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings=\"NaN\")\nqplot(head_peak,maxsdf*1400,data=p)+facet_wrap(~Neuron,ncol=10)\nqplot(head_peak,maxsdf*1400,data=subset(p,head_peak>0))+\n  facet_wrap(~Neuron,ncol=2)+\n  stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')\np %>%\n  group_by(Neuron) %>%\n  filter(head_peak>0) %>%\n  do(p.right=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%\n  merge(p,by=\"Neuron\")%>%\n  group_by(Neuron)%>%\n  filter(head_peak<0) %>%\n  do(p.left=summary(lm(maxsdf ~ head_peak,data=.))$coefficients[8]) %>%\n  merge(p,by=\"Neuron\")->\n  m\n\np %>%\n  group_by(Neuron) %>%\n  do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],\n     p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],\n     p.left.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],\n     p.left.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],\n     p.right.slope=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],\n     p.right.int=summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->mm\n\npp<-merge(mm,p,by=\"Neuron\")\n\n  ",
    "created" : 1424123448912.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2651503088",
    "id" : "CFCB8903",
    "lastKnownWriteTime" : 1426355457,
    "path" : "~/MATLAB/NRGStimAnalysis/R analysis/roughdraft.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled3"
    },
    "source_on_save" : false,
    "type" : "r_source"
}