{
    "contents" : "---\ntitle: \"NRGFigs\"\noutput:\n  pdf_document:\n    keep_tex: yes\n---\n```{r load csv, cache=FALSE,message=FALSE,warning=FALSE,fig.cap='Table 1: Regression results from fitting method for each neuron'}\nlibrary(knitr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(xtable)\nfilename<-\"~/MATLAB/NeurophysNRG/bestFitLRResort.csv\"\nd <- read.csv(filename, na.strings=\"NaN\")\nr<-read.csv('peakregressions.csv')\ngs<-read.csv('~/MATLAB/NeurophysNRG/fitGSPlm.csv')\nr<-r[,2:12]\n```\n\n```{r formulatable, results=\"asis\"}\nptab<-subset(d,d$rsquared>0)\ntab<-xtable(ptab[,1:4],caption='This table shows the results of a step-wise fitting procedure that with a threshold for inclusion of an increase of 0.5 in the R2')\nprint(tab,comment=FALSE)\n```\n\n```{r coefCounts,warning=FALSE,message=FALSE}\n\ns<-d %>% \n  select(rhv:lea) %>% \n  mutate_each(funs(!is.na(.))) %>%\n  summarise_each(funs(sum)) %>% \n  gather('c','n',1:12) %>%\n  mutate(c=reorder(c,desc(n)))\n\np<-ggplot(aes(y=n),data=s)+theme(axis.text.x=element_text(size=18,angle=45, hjust=1))\np+geom_bar(aes(x=s$c),stat='identity')+xlab('Coefficient')+ylab('Count')\n\n```\n\n```{r staticTable,results='asis'}\nstaticBestFitLR <- read.csv(\"~/MATLAB/NeurophysNRG/Resort/staticBestFitLR.csv\", na.strings=\"NaN\")\n\nstaticBestFitLR %>%\n  select(1:6) %>%\n  rename(Rightward.Eye=rep,Leftward.Eye=lep,Rightward.Head=rhp) %>%\n  gather('coef','b',4:6) %>%\n  group_by(Neuron) %>%\n  summarise(Coef=max(b),Position.Type=coef[b==Coef]) %>%\n  arrange(desc(Coef))-> t\ncaption.static<-'Coefficient of Static Acitivy. This table shows the fit value for the position parameter that provided the greatest contribution to the model fr ~ rhp+lhp+rep+lep. Only cells that included a position parameter in the stepwise fit outcome are included.'\nstatic.table<-xtable(t)\nprint(static.table,comment=FALSE)\n```\n\n```{r gspdiff, message=FALSE,warning=FALSE}\n\ng<-subset(gs,rsquared>0) #gs loaded in first chunk\ntall<-g %>% gather(key,value,c(6,7,8,9,10,12))\n\n#tall$key<-factor(tall$key,levels=c('rhv','lhv','rep','lep','rhp','rha'))\n#qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name=\"Trial\\nType\")\n\ntall<-g %>% gather(key,value,c(6,7))\n#qplot(value,facets=key~.,data=tall,fill=tall$gsp,binwidth=0.1)+scale_fill_discrete(name=\"Trial\\nType\")\n\nqplot(key,value,data=tall,geom='boxplot',fill=gsp)+\n  scale_fill_grey(start=0)+\n  theme_bw()+\n  theme(legend.position = \"bottom\")\n```\n\n```{r ttestovgsps,results='asis'}\ng %>% \n  select(1,5,6) %>% \n  spread(gsp,rhv) %>% \n  mutate(rhv=ps-gs)-> rdiff\ng %>% \n  select(1,5,7) %>% \n  spread(gsp,lhv) %>% \n  mutate(lhv=ps-gs)-> ldiff\n\nrd<-t.test(rdiff$rhv)\nld<-t.test(ldiff$lhv)\nqplot(ldiff$lhv,binwidth=0.1)+geom_vline(x=ld$estimate,size=2)\nqplot(rdiff$rhv,binwidth=0.1)+geom_vline(x=rd$estimate,size=2)\n\n\n```\n\n```{r peakAnalysis,fig.width=7, fig.height=33}\np<-read.csv('~/MATLAB/NeurophysNRG/peakAnalysis.csv',na.strings=\"NaN\")\nsource('~/MATLAB/NeurophysNRG/RCode/StatSmoothFunc.R')\nqplot(head_peak,maxsdf*1400,data=subset(p,head_peak>0))+\n  facet_wrap(~Neuron,ncol=2)+\n  stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)+stat_smooth(method='lm')\n```\n\n```{r gspsAnalysis}\np$isgs<-as.factor(p$isgs)\np %>%\n  group_by(Neuron) %>%\n  do(p.right=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak>20)))$coefficients[8],\n     p.left=summary(lm(maxsdf ~ head_peak,data=filter(.,head_peak< -20)))$coefficients[8],\n     p.left.slope=\n       summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[16],\n     p.left.int=\n       summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak< -20)))$coefficients[15],\n     p.right.slope=\n       summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[16],\n     p.right.int=\n       summary(lm(maxsdf ~ head_peak*isgs,data=filter(.,head_peak>20)))$coefficients[15]) ->\n  mm\n\npp<-merge(mm,p,by=\"Neuron\")\n\nqplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak> 20,p.right<0.001,p.right.slope<0.001 | p.right.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)\n\nqplot(head_peak,maxsdf*1400,col=isgs,data=filter(pp,head_peak< -20,p.left<0.001,p.left.slope<0.001 | p.left.int<0.001))+facet_wrap(~Neuron,ncol=3)+stat_smooth(method='lm')+stat_smooth_func(method='lm',geom='text',parse=TRUE,hjust=0)\n```\n",
    "created" : 1426043610369.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1512202689",
    "id" : "5A4F24C8",
    "lastKnownWriteTime" : 1426355702,
    "path" : "~/MATLAB/NeurophysNRG/RCode/ExtraFigs.Rmd",
    "project_path" : "ExtraFigs.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}